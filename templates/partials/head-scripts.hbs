<!-- JS Detection & Theme Script - Must run before render -->
<script>
    (function() {
        // Remove no-js class immediately if JS is working
        document.documentElement.classList.remove('no-js');
        
        // Get stored theme or use system preference
        const storedTheme = localStorage.getItem('theme');
        const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const theme = storedTheme || (systemPrefersDark ? 'dark' : 'light');
        
        // Apply theme immediately to prevent flash
        document.documentElement.setAttribute('data-theme', theme);
        document.documentElement.style.colorScheme = theme;
        
        // Update meta theme-color dynamically
        const metaThemeColor = document.querySelector('meta[name="theme-color"]');
        if (metaThemeColor) {
            metaThemeColor.setAttribute('content', theme === 'light' ? '#f1f5f9' : '#0d1117');
        }
    })();
</script>

<!-- Resource Hints for Performance -->
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="dns-prefetch" href="https://esm.sh">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://esm.sh" crossorigin>
